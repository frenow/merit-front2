!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.cachePolyfill=t():e.cachePolyfill=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function o(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var a=new WeakMap,u=function(e){return a.get(e)},c=function(e,t){if(t.length<e)throw new TypeError(e+" argument required, but only "+t.length+" present.")},i=function(e){return e&&e instanceof Request};function s(){return new Promise(function(e){var t=indexedDB.open("cachestorage",4);t.onupgradeneeded=function(){var e=t.result;e.createObjectStore("storages",{keyPath:"cacheName"}),e.createObjectStore("caches",{autoIncrement:!0}).createIndex("cacheName","cacheName",{unique:!1})},t.onsuccess=function(){e(t.result)}})}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),a.set(this,t)}return n(e,[{key:"match",value:async function(){return(await this.matchAll.apply(this,arguments))[0]}},{key:"matchAll",value:async function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("HEAD"===e.method)return[];var t=u(this),r=[],n=(await s()).transaction("caches","readonly");return n.objectStore("caches").index("cacheName").openCursor(IDBKeyRange.only(t)).onsuccess=function(){var t=this.result;if(t){if((e.url||e)===t.value.reqUrl){var n=Object.assign({url:t.value.resUrl},t.value),o=new Response(t.value.body,n);r.push(o)}t.continue()}},new Promise(function(e){return n.oncomplete=function(){return e(r)}})}},{key:"add",value:async function(e){return c(1,arguments),this.addAll([e])}},{key:"addAll",value:async function(e){var t=this;c(1,arguments);var r=[],n=async function(e){if(e=new Request(e),!/^((http|https):\/\/)/.test(e.url))throw new TypeError('Add/AddAll does not support schemes other than "http" or "https"');if("GET"!==e.method)throw new TypeError("Add/AddAll only supports the GET request method");e.clone();await fetch(e).then(function(t){if(206===t.status)throw new TypeError("Partial response (status code 206) is unsupported");if(!t.ok)throw new TypeError("Request failed");r.push([e,t])}),f=e},a=!0,u=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(a=(s=l.next()).done);a=!0){var f=s.value;await n(f)}}catch(e){u=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(u)throw i}}await Promise.all(r.map(function(e){return t.put.apply(t,o(e))}))}},{key:"put",value:async function(e,t){if(c(2,arguments),e=i(e)?e:new Request(e),await this.delete(e),!/^((http|https):\/\/)/.test(e.url))throw new TypeError("Request scheme '"+e.url.split(":")[0]+"' is unsupported");if("GET"!==e.method)throw new TypeError("Request method '"+e.method+"' is unsupported");if(206===t.status)throw new TypeError("Partial response (status code 206) is unsupported");var r=t.headers.get("Vary");if(r&&r.includes("*"))throw new TypeError("Vary header contains *");if(null!=t.body&&t.bodyUsed)throw new TypeError("Response body is already used");var n={cacheName:u(this),headers:[].concat(o(t.headers)),status:t.status,statusText:t.statusText,body:await t.arrayBuffer(),reqUrl:e.url.replace(/#.*$/,""),resUrl:t.url.replace(/#.*$/,""),reqMethod:e.method},a=await s();await new Promise(function(e,t){var r=a.transaction("caches","readwrite");r.objectStore("caches").put(n),r.oncomplete=function(){return e()},r.onerror=function(){return t(transaction.error)}})}},{key:"delete",value:async function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};c(1,arguments);var r=u(this),n=t.ignoreMethod,o=i(e)?e:new Request(e);if(!["GET","HEAD"].includes(o.method)&&n)return!1;var a=o.method,l=o.url.replace(/#.*$/,""),f=(await s()).transaction("caches","readwrite"),h=f.objectStore("caches"),d=!1;return h.index("cacheName").openCursor(IDBKeyRange.only(r)).onsuccess=function(){var e=this.result;e&&(l!==e.value.reqUrl||!n&&a!==e.value.reqMethod||(d=!0,h.delete(e.primaryKey)),e.continue())},new Promise(function(e){return f.oncomplete=function(){return e(d)}})}},{key:"keys",value:async function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0,n=u(this),o=t.ignoreMethod,a=void 0!==o&&o,c=t.ignoreSearch,i=void 0!==c&&c;if(void 0!==e&&(e=new Request(e),r=e.url.split("#")[0],"GET"!==e.method&&!a))return[];var l=void 0===e?function(e){return e}:function(e){return e.filter(function(e){return i?(e=e.reqUrl.split("?")[0],r=r.split("?")[0]):e=e.reqUrl,e===r})},f=await s();return l(await new Promise(function(e){var t=f.transaction("caches","readonly").objectStore("caches").index("cacheName").getAll(IDBKeyRange.only(n));t.onsuccess=function(){return e(t.result)}})).map(function(e){return new Request(e.reqUrl)})}}]),e}();e.exports=l},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=r(0);function a(){return new Promise(function(e){var t=indexedDB.open("cachestorage",4);t.onupgradeneeded=function(){var e=t.result;e.createObjectStore("storages",{keyPath:"cacheName"});e.createObjectStore("caches",{autoIncrement:!0}).createIndex("cacheName","cacheName",{unique:!1})},t.onsuccess=function(){e(t.result)}})}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,[{key:"delete",value:async function(e){if(!(await this.keys()).includes(e))return!1;var t=(await a()).transaction(["storages","caches"],"readwrite"),r=(t.objectStore("storages").delete(e),t.objectStore("caches"));return r.index("cacheName").getAllKeys(IDBKeyRange.only(e)).onsuccess=function(e){var t=!0,n=!1,o=void 0;try{for(var a,u=this.result[Symbol.iterator]();!(t=(a=u.next()).done);t=!0){var c=a.value;r.delete(c)}}catch(e){n=!0,o=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw o}}},new Promise(function(e,r){t.oncomplete=function(){return e(!0)},t.onerror=function(){return r(!1)}})}},{key:"has",value:function(e){return this.keys().then(function(t){return t.includes(e)})}},{key:"keys",value:async function(){var e=(await a()).transaction("storages","readonly").objectStore("storages").getAllKeys();return new Promise(function(t){return e.onsuccess=function(){return t(e.result)}})}},{key:"match",value:async function(){var e=await this.keys(),t=!0,r=!1,n=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var u=o.value,c=await this.open(u),i=await c.match.apply(c,arguments);if(i)return i}}catch(e){r=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(r)throw n}}}},{key:"open",value:async function(e){if(arguments.length<1)throw new TypeError(i+" argument required, but only "+arguments.length+" present.");var t=await a();return await new Promise(function(r,n){var o=t.transaction("storages","readwrite");o.objectStore("storages").put({cacheName:e}),o.oncomplete=function(){return r()},o.onerror=function(){return n(transaction.error)}}),new o(e)}},{key:Symbol.toStringTag,value:function(){return"CacheStorage"}}]),e}();e.exports={Cache:o,CacheStorage:u,caches:new u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}})})}])});
//# sourceMappingURL=cache.min.js.map